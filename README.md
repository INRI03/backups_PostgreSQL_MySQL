# *Домашнее задание к занятию "Резервное копирование баз данных" - Юрий Спиривак*


### Задание 1. Резервное копирование.

### Кейс
**Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования.**

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

Необходимо восстанавливать данные в полном объёме за предыдущий день.

### *Поскольку данные нужны в полном объеме, то подойдет либо полный бэкап (в принципе он подходит в любой ситуации, если не стоит вопрос со свободной памятью на сервере и время позволяет делать его), либо дифференциальный, так как он является накопительным и будет содержать все данные, начиная с последнего полного бэкапа, а не только те, что были изменены в предыдущий день.*

Необходимо восстанавливать данные за час до предполагаемой поломки.

### *Если сервер с данными через час после их восстановления все равно упадет, и никаких дополнительных бэкапов за этот час не будет, то в данном случае подойдет только полный бэкап, который будет содержать в себе все данные, а не только измененные или накопленные. Любой другой бэкап здесь не подходит, т.к. инкрементный будет содержать лишь крохотную часть данных, а дифференциальный чуть больше, но это все равно будет лишь разница между ним и последним полным бэкапом.*



---

### Задание 2. PostgreSQL.

С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

### *В терминал из папки bin программы Postgresql вводится команда:* 
*pg_dump -h localhost -p 5432 -d postgres -U postgres > E:\01\backup.backup*

Хост, порт, база для бэкапа, файл и формат файла выхода бэкапа могут варьироваться.

--
### *Для восстановления бэкапа, не выходя из той же папки bin, следует выполнить команду:*
*pg_restore -d postgres –h localhost –p 5432 –U postgres E:\документы\SQL\avia.backup*


---

### Задание 3. MySQL

### *С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL.*

*mysqlbackup --defaults-file=/home/dbadmin/my.cnf --incremental --incremental-base=history:last_backup --backup-dir=/home/dbadmin/temp_dir --backup-image=incremental_image1.bi backup-to-image*

### *или такой, с помошью утилиты Xtrabackup:*
**Cначала создается полный бэкап, который потом станет отправной точкой для создания инкрементального бэкапа:**

*xtrabackup --backup --target-dir=/data/backups/base*

**Cоздание инкрементального бэкапа:**

*xtrabackup --backup --target-dir=/data/backups/inc1 --incremental-basedir=/data/backups/base* - .


P.S. Насколько я понял, утилита mysqlbackup доступна только в Enterprise версии СУБД, поэтому проверить ее в действии не предоставляется возможным. Обычная бесплатная версия СУБД предоставляет лишь утилиту mysqldump, с помощью которой можно сделать только полный бэкап, а инкрементный – нет. Вот пример команды создания полного бэкапа (выполняется также из директории  bin):

*mysqldump -u root -p sakila > E:\mysql_fullbackup.sql*
